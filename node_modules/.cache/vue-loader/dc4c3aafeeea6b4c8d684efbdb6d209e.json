{"remainingRequest":"/Users/const/Documents/Movie/Slog/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/const/Documents/Movie/Slog/src/components/Site.vue?vue&type=style&index=0&id=0354e012&scoped=true&lang=less&","dependencies":[{"path":"/Users/const/Documents/Movie/Slog/src/components/Site.vue","mtime":1555641748505},{"path":"/Users/const/Documents/Movie/Slog/node_modules/css-loader/index.js","mtime":1552975947402},{"path":"/Users/const/Documents/Movie/Slog/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1552975955943},{"path":"/Users/const/Documents/Movie/Slog/node_modules/postcss-loader/src/index.js","mtime":1552975953218},{"path":"/Users/const/Documents/Movie/Slog/node_modules/less-loader/dist/cjs.js","mtime":1552975951040},{"path":"/Users/const/Documents/Movie/Slog/node_modules/cache-loader/dist/cjs.js","mtime":1552975946601},{"path":"/Users/const/Documents/Movie/Slog/node_modules/vue-loader/lib/index.js","mtime":1552975955943}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.Site {\n    width: 97%;\n    text-align: right;\n}\n.SitePanel {\n    margin: 0 auto;\n    width: 96%;\n}\n.SitePanel .el-icon-success {\n    color: #67c23a;\n}\n.SitePanel .el-icon-warning {\n    color: #f56c6c;\n}\n",{"version":3,"sources":["Site.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Site.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <div class=\"setting\">\n        <Crumb title=\"Site\"/>\n        <div class=\"Site\">\n            <el-button type=\"primary\" size=\"mini\" plain @click=\"onNginx()\">nginx.conf</el-button>\n            <el-button type=\"success\" size=\"mini\" plain @click=\"onNewSite()\">new Site</el-button>\n        </div>\n        <div class=\"SitePanel\">\n            <template>\n            <el-table\n                :data=\"siteData\"\n                height=\"630\"\n                style=\"width: 100%\">\n                <el-table-column\n                prop=\"time\"\n                label=\"time\"\n                width=\"180\">\n                </el-table-column>\n                <el-table-column\n                prop=\"domain\"\n                label=\"domain\"\n                width=\"180\">\n                </el-table-column>\n                <el-table-column\n                label=\"status\">\n                    <template slot-scope=\"scope\">\n                        <template v-if=\"scope.row.status\">\n                            <i class=\"el-icon-success\"></i>\n                        </template>\n                        <template v-else>\n                            <i class=\"el-icon-warning\"></i>\n                        </template>\n                    </template>\n                </el-table-column>\n                <el-table-column\n                prop=\"directory\"\n                label=\"directory\">\n                </el-table-column>\n                <el-table-column label=\"操作\" width=\"230\">\n                    <template slot-scope=\"scope\">\n                        <el-button\n                        size=\"mini\"\n                        type=\"success\"\n                        @click=\"handleSet(scope.row.id)\">set</el-button>\n                        <el-button\n                        size=\"mini\"\n                        type=\"warning\"\n                        @click=\"handleStart(scope.row.id, scope.$index)\">{{ scope.row.status ? 'stop' : 'start' }}</el-button>\n                        <el-button\n                        size=\"mini\"\n                        type=\"danger\"\n                        @click=\"handleDel(scope.row.id, scope.$index)\">del</el-button>\n                    </template>\n                </el-table-column>\n            </el-table>\n            </template>\n        </div>\n        <!--【新增站点】-->\n        <el-dialog\n        title=\"提示\"\n        :visible.sync=\"newDialog\"\n        width=\"42%\"\n        :show-close=\"false\"\n        center>\n        <span>\n            <el-form :model=\"ruleNew\" :rules=\"rules\" ref=\"ruleNew\" label-width=\"100px\" class=\"demo-ruleForm\">\n                <el-form-item label=\"domain\" prop=\"domain\">\n                    <el-input v-model=\"ruleNew.domain\" placeholder=\"baidu.com\"></el-input>\n                </el-form-item>\n                <el-row>\n                    <el-col :span=\"12\">\n                        <el-form-item label=\"criterion\" prop=\"criterion\">\n                            <el-switch v-model=\"ruleNew.criterion\"></el-switch>\n                        </el-form-item>\n                    </el-col>\n                    <el-col :span=\"12\">\n                        <el-form-item label=\"start\" prop=\"start\">\n                            <el-switch v-model=\"ruleNew.start\"></el-switch>\n                        </el-form-item>\n                    </el-col>\n                </el-row>\n                <el-form-item label=\"directory\" prop=\"directory\">\n                    <el-input v-model=\"ruleNew.directory\" placeholder=\"baidu\"></el-input>\n                </el-form-item>\n                <el-form-item>\n                    <el-button @click=\"newDialog = false\">reset</el-button>\n                    <el-button type=\"success\" @click=\"submitNew('ruleNew')\">add</el-button>\n                </el-form-item>\n            </el-form>\n        </span>\n        </el-dialog>\n        <!--【删除站点】-->\n        <el-dialog\n            title=\"delete site\"\n            :visible.sync=\"delDialog\"\n            width=\"30%\"\n            :show-close=\"false\"\n            custom-class=\"dialogDelete\">\n            <span>Are sure delete this site</span>\n            <span slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"delDialog = false\">取 消</el-button>\n                <el-button type=\"primary\" @click=\"onDelete()\">确 定</el-button>\n            </span>\n        </el-dialog>\n        <!--【编辑器】-->\n        <el-dialog\n            title=\"edit site\"\n            :visible.sync=\"codemirrorDialog\"\n            width=\"60%\"\n            :show-close=\"false\"\n            custom-class=\"dialogDelete\">\n            <span>\n                <codemirror\n                    ref=\"myCm\"\n                    :value=\"codeMsg\"\n                    v-model=\"codeMsg\"\n                    :options=\"cmOptions\"\n                    :change=\"onChange()\"\n                    class=\"code\">\n                </codemirror>\n            </span>\n            <span slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"codemirrorDialog = false; nginxStatus = false;\">取 消</el-button>\n                <el-button type=\"primary\" @click=\"nginxStatus ? onSiteNginx() : onSiteFile()\">确 定</el-button>\n            </span>\n        </el-dialog>\n    </div>\n</template>\n\n<script lang=\"ts\">\nimport axios from 'axios';\nimport Qs from 'qs';\nimport { codemirror } from 'vue-codemirror'\nrequire(\"codemirror/mode/python/python.js\")\nrequire('codemirror/addon/fold/foldcode.js')\nrequire('codemirror/addon/fold/foldgutter.js')\nrequire('codemirror/addon/fold/brace-fold.js')\nrequire('codemirror/addon/fold/xml-fold.js')\nrequire('codemirror/addon/fold/indent-fold.js')\nrequire('codemirror/addon/fold/markdown-fold.js')\nrequire('codemirror/addon/fold/comment-fold.js')\nimport {onTips} from '@/assets/js/common.js';\nimport Crumb from '@/components/Crumb.vue'\nexport default {\n    name: 'Setting',\n    components: {\n        Crumb,\n        codemirror\n    },\n    data() {\n        return {\n            siteData: [],\n            newDialog: false,\n            delDialog: false,\n            nginxStatus: false,\n            nowID: Number,\n            nowIndex: Number,\n            ruleNew: {\n                domain: '',\n                criterion: true,\n                start: true,\n                directory: ''\n            },\n            rules: {\n            domain: [\n                { required: true, message: '请输入域名~', trigger: 'blur' },\n                { min: 2, max: 100, message: '域名输入错误~', trigger: 'blur' }\n            ],\n            directory: [\n                { required: true, message: '请输入站点根目录名称~', trigger: 'blur' },\n                { min: 3, max: 30, message: '站点根目录名称错误~', trigger: 'blur' }\n            ]\n            },\n            codemirrorDialog: false,\n            codeMsg: '',\n            myCm: '',\n            cmOptions: {\n                value: '',\n                mode: 'text/html',\n                theme: 'foo bar',\n                indentUnit: 2,\n                smartIndent: true,\n                tabSize: 4,\n                readOnly: false,\n                showCursorWhenSelecting: true,\n                lineNumbers: true,\n            }\n        }\n    },\n    created() {\n        let that = this;\n        axios.post('/api/project', {}, {})\n        .then(function(res) {\n            if (res.data.status) {\n                that.siteData = res.data.data;\n            }\n        })\n        .catch(function(err) {\n            onTips(that, 'error', '网络错误～');\n        })\n    },\n    methods: {\n        onNginx: function() {\n            let that = this;\n            that.nginxStatus = true;\n            axios.post('/api/nginx', {}, {})\n            .then(function(res) {\n                if (res.data.status) {\n                    that.codeMsg = res.data.data;\n                    that.codemirrorDialog = true;\n                }\n            })\n            .catch(function() {\n                onTips(that, 'error', '网络错误～');\n            })\n        },\n        onSiteNginx: function() {\n            let that = this;\n            let data = {\n                file: that.codeMsg\n            };\n            axios.post('/api/config', Qs.stringify(data), {})\n            .then(function(res) {\n                if (res.data.status) {\n                    that.nginxStatus = false;\n                    that.codemirrorDialog = false;\n                    onTips(that, 'success', res.data.info);\n                } else {\n                    onTips(that, 'error', res.data.info);\n                }\n            })\n            .catch(function() {\n                onTips(that, 'error', '网络错误～');\n            })\n        },\n        onNewSite: function() {\n            this.newDialog = true;\n        },\n        handleSet: function(id) {\n            let that = this;\n            that.nowID = id;\n            let data = {\n                id: id\n            };\n            axios.post('/api/rest', Qs.stringify(data), {})\n            .then(function(res) {\n                if (res.data.status) {\n                    that.codeMsg = res.data.data;\n                    that.codemirrorDialog = true;\n                }\n            })\n            .catch(function(err) {\n                onTips(that, 'error', '网络错误～');\n            })\n        },\n        handleStart: function(id, index) {\n            let that = this;\n            let data = {\n                id: id,\n                status: !that.siteData[index].status ? 1 : 0\n            };\n            axios.post('/api/start', Qs.stringify(data), {})\n            .then(function(res) {\n                if (res.data.status) {\n                    that.siteData[index].status = !that.siteData[index].status;\n                    onTips(that, 'success', res.data.info);\n                } else {\n                    onTips(that, 'error', res.data.info);\n                }\n            })\n            .catch(function(err) {\n                onTips(that, 'error', '网络错误～');\n            })\n        },\n        handleDel: function(id, index) {\n            this.delDialog = true;\n            this.nowID = id;\n            this.nowIndex = index;\n        },\n        submitNew: function(ruleNew) {\n            let that = this;\n            that.$refs[ruleNew].validate((valid) => {\n                if (valid) {\n                    let data = {\n                        domain: that.ruleNew.domain,\n                        criterion: that.ruleNew.criterion ? 1 : 0,\n                        status: that.ruleNew.start ? 1 : 0,\n                        directory: that.ruleNew.directory\n                    }\n                    axios.post('/api/new', Qs.stringify(data), {})\n                    .then(function(res) {\n                        if (res.data.status) {\n                            that.newDialog = false;\n                            that.siteData.push(res.data.data[0]);\n                            onTips(that, 'success', res.data.info);\n                        } else {\n                            onTips(that, 'error', res.data.info);\n                        }\n                    })\n                    .catch(function(err) {\n                        onTips(that, 'error', '网络错误～');\n                    })\n                } else {\n                    return false;\n                }\n            });\n        },\n        onDelete: function() {\n            let that = this;\n            let data = {\n                id: that.nowID\n            }\n            axios.post('/api/clear', Qs.stringify(data), {})\n            .then(function(res) {\n                if (res.data.status) {\n                    that.delDialog = false;\n                    that.siteData.splice(that.nowIndex, 1)\n                    onTips(that, 'success', res.data.info);\n                }\n            })\n            .catch(function() {\n                onTips(that, 'error', '网络错误～');\n            })\n        },\n        onSiteFile: function() {\n            let that = this;\n            let data = {\n                id: that.nowID,\n                file: that.codeMsg\n            };\n            axios.post('/api/adapt', Qs.stringify(data), {})\n            .then(function(res) {\n                if (res.data.status) {\n                    that.codemirrorDialog = false;\n                    onTips(that, 'success', res.data.info);\n                } else {\n                    onTips(that, 'error', res.data.info);\n                }\n            })\n            .catch(function() {\n                onTips(that, 'error', '网络错误～');\n            })\n        },\n        onChange: function() {\n            console.log('2345')\n        }\n    }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped lang=\"less\">\n.Site {\n    width: 97%;\n    text-align: right;\n}\n.SitePanel {\n    margin: 0 auto;\n    width: 96%;\n}\n.SitePanel .el-icon-success {\n    color: #67c23a;\n}\n.SitePanel .el-icon-warning {\n    color: #f56c6c;\n}\n</style>"]}]}