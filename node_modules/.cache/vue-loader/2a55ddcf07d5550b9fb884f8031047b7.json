{"remainingRequest":"/Users/const/Documents/Movie/Slog/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/const/Documents/Movie/Slog/src/components/Manage.vue?vue&type=style&index=0&id=feabedd6&scoped=true&lang=less&","dependencies":[{"path":"/Users/const/Documents/Movie/Slog/src/components/Manage.vue","mtime":1570777994790},{"path":"/Users/const/Documents/Movie/Slog/node_modules/css-loader/index.js","mtime":1552975947402},{"path":"/Users/const/Documents/Movie/Slog/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1552975955943},{"path":"/Users/const/Documents/Movie/Slog/node_modules/postcss-loader/src/index.js","mtime":1552975953218},{"path":"/Users/const/Documents/Movie/Slog/node_modules/less-loader/dist/cjs.js","mtime":1552975951040},{"path":"/Users/const/Documents/Movie/Slog/node_modules/cache-loader/dist/cjs.js","mtime":1552975946601},{"path":"/Users/const/Documents/Movie/Slog/node_modules/vue-loader/lib/index.js","mtime":1552975955943}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.manage {\n    width: 100%;\n    height: 100%;\n    background-color: #ffffff;\n}\n.usermanage {\n    margin: 0 auto;\n    width: 92%;\n}\n.usermanage img {\n    width: 38px;\n    height: 38px;\n}\n",{"version":3,"sources":["Manage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Manage.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <div class=\"manage\" ref=\"manage\">\n        <div class=\"usermanage\">\n            <el-table :data=\"manageData\" style=\"width: 100%\" :height=\"tableHeight + 'px'\">\n                <el-table-column label=\"序号\" prop=\"id\" width=\"60px\"></el-table-column>\n                <el-table-column label=\"角色\" prop=\"role\">\n                    <template slot-scope=\"scope\">\n                        <span>{{ onFilter(scope.row.role) }}</span>\n                    </template>\n                </el-table-column>\n                <el-table-column label=\"用户名\" prop=\"name\"></el-table-column>\n                <el-table-column label=\"头像\">\n                    <template slot-scope=\"scope\">\n                        <img :src=\"scope.row.icon\" alt=\"\" />\n                    </template>\n                </el-table-column>\n                <el-table-column label=\"日期\" prop=\"time\"></el-table-column>\n                <el-table-column label=\"操作\" width=\"260px\">\n                    <template slot-scope=\"scope\">\n                        <el-button\n                        size=\"mini\"\n                        type=\"success\"\n                        round\n                        @click=\"handleAdd(scope.$index, scope.row)\">新增</el-button>\n                        <el-button\n                        size=\"mini\"\n                        type=\"primary\"\n                        round\n                        @click=\"handleEdit(scope.$index, scope.row)\">编辑</el-button>\n                        <el-button\n                        size=\"mini\"\n                        type=\"danger\"\n                        round\n                        :disabled=\"scope.row.unionid == '000001' ? true:false\"\n                        @click=\"handleDelete(scope.$index, scope.row)\">删除</el-button>\n                    </template>\n                </el-table-column>\n            </el-table>\n        </div>\n        <!--【新增对话框】-->\n        <el-dialog title=\"新增\" :visible.sync=\"dialogAdd\" top=\"18vh\" :show-close=\"false\" width=\"380px\" custom-class=\"dialogAdd\">\n            <el-form ref=\"addForm\" :model=\"addForm\" :rules=\"addRules\" label-width=\"80px\">\n                <el-form-item label=\"头像\">\n                    <el-upload\n                    class=\"avatar-uploader\"\n                    action=\"/api/manage/upload\"\n                    enctype=\"multipart/form-data\"\n                    method=\"post\"\n                    name=\"image[]\"\n                    :show-file-list=\"false\"\n                    :on-success=\"handleAvatarSuccess\"\n                    :before-upload=\"beforeAvatarUpload\">\n                    <img v-if=\"addForm.imageUrl\" :src=\"addForm.imageUrl\" class=\"avatar\">\n                    <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n                    </el-upload>\n                </el-form-item>\n                <el-form-item label=\"角色\" prop=\"role\">\n                    <el-select v-model=\"addForm.role\" placeholder=\"请选择权限\">\n                        <el-option label=\"超级管理员\" value=\"0\"></el-option>\n                        <el-option label=\"管理员\" value=\"1\"></el-option>\n                        <el-option label=\"文案编辑\" value=\"2\"></el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item label=\"用户名\" prop=\"name\">\n                    <el-input type=\"text\" v-model=\"addForm.name\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"密码\" prop=\"pwd\">\n                    <el-input type=\"password\" v-model=\"addForm.pwd\"></el-input>\n                </el-form-item>\n                <el-form-item>\n                    <el-button type=\"primary\" @click=\"onAddSubmit('addForm')\">立即创建</el-button>\n                    <el-button @click=\"dialogAdd = false\">取消</el-button>\n                </el-form-item>\n            </el-form>\n        </el-dialog>\n        <!--【编辑对话框】-->\n        <el-dialog title=\"编辑\" :visible.sync=\"dialogEdit\" top=\"18vh\" :show-close=\"false\" width=\"380px\" custom-class=\"dialogEdit\">\n            <el-form ref=\"editForm\" :model=\"editForm\" :rules=\"editRules\" label-width=\"80px\">\n                <el-form-item label=\"头像\">\n                    <el-upload\n                    class=\"avatar-uploader\"\n                    action=\"/api/manage/upload\"\n                    enctype=\"multipart/form-data\"\n                    method=\"post\"\n                    name=\"image[]\"\n                    :show-file-list=\"false\"\n                    :on-success=\"handleAvatarSuccess\"\n                    :before-upload=\"beforeAvatarUpload\">\n                    <img v-if=\"editForm.imageUrl\" :src=\"editForm.imageUrl\" class=\"avatar\">\n                    <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n                    </el-upload>\n                </el-form-item>\n                <el-form-item label=\"角色\" prop=\"role\">\n                    <el-select v-model=\"editForm.role\" placeholder=\"请选择权限\">\n                        <el-option label=\"超级管理员\" value=\"0\"></el-option>\n                        <el-option label=\"管理员\" value=\"1\"></el-option>\n                        <el-option label=\"文案编辑\" value=\"2\"></el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item label=\"用户名\" prop=\"name\">\n                    <el-input type=\"text\" v-model=\"editForm.name\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"密码\" prop=\"pwd\">\n                    <el-input type=\"password\" v-model=\"editForm.pwd\"></el-input>\n                </el-form-item>\n                <el-form-item>\n                    <el-button type=\"primary\" @click=\"onEditSubmit('editForm')\">立即创建</el-button>\n                    <el-button @click=\"dialogEdit = false\">取消</el-button>\n                </el-form-item>\n            </el-form>\n        </el-dialog>\n        <!--【删除对话框】-->\n        <el-dialog title=\"警告\" :visible.sync=\"dialogDel\" top=\"30vh\" :show-close=\"false\" width=\"320px\" custom-class=\"dialogDel\">\n            <span>你确定要删除该用户吗 ?</span>\n            <span slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"dialogDel = false\">取 消</el-button>\n                <el-button @click=\"onDelSubmit()\">确 定</el-button>\n            </span>\n        </el-dialog>\n    </div>\n</template>\n\n<script lang=\"ts\">\nexport default {\n    name: 'Manage',\n    data() {\n        return {\n            tableHeight: '',\n            manageData: [],\n            dialogAdd: false,\n            addForm: {\n                img: '',\n                imageUrl: '',\n                role: '',\n                name: '',\n                pwd: ''\n            },\n            addRules: {\n                role: [\n                    { required: true, message: '请至少选择一个活动性质', trigger: 'change' }\n                ],\n                name: [\n                    { required: true, message: '请输入用户名', trigger: 'blur' },\n                    { min: 5, max: 10, message: '长度在 5 到 10 个字符', trigger: 'blur' }\n                ],\n                pwd: [\n                    { required: true, message: '请输入密码', trigger: 'blur' },\n                    { min: 6, max: 12, message: '长度在 6 到 12 个字符', trigger: 'blur' }\n                ]\n            },\n            dialogEdit: false,\n            editForm: {\n                index: Number,\n                unionid: '',\n                img: '',\n                imageUrl: '',\n                role: '',\n                name: '',\n                pwd: '******'\n            },\n            editRules: {\n                role: [\n                    { required: true, message: '请至少选择一个活动性质', trigger: 'change' }\n                ],\n                name: [\n                    { required: true, message: '请输入用户名', trigger: 'blur' },\n                    { min: 5, max: 10, message: '长度在 5 到 10 个字符', trigger: 'blur' }\n                ],\n                pwd: [\n                    { required: true, message: '请输入密码', trigger: 'blur' },\n                    { min: 6, max: 12, message: '长度在 6 到 12 个字符', trigger: 'blur' }\n                ]\n            },\n            dialogDel: false,\n            delForm: {\n                index: Number,\n                unionid: ''\n            }\n        }\n    },\n    created() {\n        let that = this;\n        that.$axios.post('/api/manage/list', {}, {})\n        .then(function(res){\n            that.manageData = res.data;\n        })\n        .catch(function(err) {\n            that.$toast(that, 'error', '网络错误～');\n        })\n    },\n    mounted() {\n        let that = this;\n        that.tableHeight = that.$refs.manage.offsetHeight;\n    },\n    methods: {\n        onFilter: function(role) {\n            switch(role)\n            {\n                case 0:\n                    return '超级管理员';\n                case 1:\n                    return '管理员';\n                case 2:\n                    return '文案编辑';\n            }\n        },\n        handleAdd(index, row) {\n            this.dialogAdd = true;\n        },\n        beforeAvatarUpload(file) {\n            let that = this;\n            const isJPG = file.type === 'image/jpeg' || file.type === 'image/png';\n            const isLt1M = file.size / 1024 / 1024 < 1;\n\n            if (!isJPG) {\n                that.$toast(that, 'error', '上传头像图片只能是 JPG PNG 格式!');\n                return;\n            }\n            if (!isLt1M) {\n                that.$toast(that, 'error', '上传头像图片大小不能超过 1MB!');\n                return;\n            }\n            return isJPG && isLt1M;\n        },\n        handleAvatarSuccess(res, file) {\n            if (this.dialogAdd) {\n                this.addForm.img = res;\n                this.addForm.imageUrl = URL.createObjectURL(file.raw);\n            } else if (this.dialogEdit) {\n                this.editForm.img = res;\n                this.editForm.imageUrl = URL.createObjectURL(file.raw);\n            }\n        },\n        onAddSubmit(addForm) {\n            let that = this;\n            that.$refs[addForm].validate((valid)=>{\n                if (valid) {\n                    that.$axios.post('/api/manage/add', that.$qs.stringify(that.addForm), {})\n                    .then(function(res){\n                        if (res.data.status) {\n                            that.dialogAdd = false;\n                            that.manageData.push(res.data.data[0]);\n                            that.$toast(that, 'success', res.data.message);\n                        } else {\n                            that.$toast(that, 'error', res.data.message);\n                        }\n                    })\n                    .catch(function(err) {\n                        that.$toast(that, 'error', '网络错误～');\n                    })\n                } else {\n                    return false;\n                }\n            })\n        },\n        handleEdit(index, row) {\n            this.editForm.index = index;\n            this.editForm.unionid = this.manageData[index].unionid;\n            this.editForm.img = this.manageData[index].img;\n            this.editForm.imageUrl = this.manageData[index].icon;\n            this.editForm.role = this.manageData[index].role.toString();\n            this.editForm.name = this.manageData[index].name;\n            this.dialogEdit = true;\n        },\n        onEditSubmit(editForm) {\n            let that = this;\n            that.$refs[editForm].validate((valid)=>{\n                if (valid) {\n                    that.$axios.post('/api/manage/edit', that.$qs.stringify(that.editForm), {})\n                    .then(function(res){\n                        if (res.data.status) {\n                            that.manageData[that.editForm.index].role = res.data.data[0].role;\n                            that.manageData[that.editForm.index].name = res.data.data[0].name;\n                            that.manageData[that.editForm.index].time = res.data.data[0].time;\n                            that.manageData[that.editForm.index].img = res.data.data[0].img;\n                            that.manageData[that.editForm.index].icon = res.data.data[0].icon;\n                            that.dialogEdit = false;\n                            that.$toast(that, 'success', res.data.message);\n                        } else {\n                            that.$toast(that, 'error', res.data.message);\n                        }\n                    })\n                    .catch(function(err) {\n                        that.$toast(that, 'error', '网络错误～');\n                    })\n                } else {\n                    return false;\n                }\n            })\n        },\n        handleDelete(index, row) {\n            this.delForm.index = index;\n            this.delForm.unionid = row.unionid;\n            this.dialogDel = true;\n        },\n        onDelSubmit() {\n            let that = this;\n            let data = {\n                'unionid': that.delForm.unionid\n            }\n            that.$axios.post('/api/manage/del', that.$qs.stringify(data), {})\n            .then(function(res){\n                if (res.data.status) {\n                    that.manageData.splice(that.delForm.index, 1);\n                    that.dialogDel = false;\n                    that.$toast(that, 'success', res.data.message);\n                } else {\n                    that.$toast(that, 'error', res.data.message);\n                }\n            })\n            .catch(function(err) {\n                that.$toast(that, 'error', '网络错误～');\n            })\n        }\n    }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped lang=\"less\">\n.manage {\n    width: 100%;\n    height: 100%;\n    background-color: #ffffff;\n}\n.usermanage {\n    margin: 0 auto;\n    width: 92%;\n}\n.usermanage img {\n    width: 38px;\n    height: 38px;\n}\n</style>"]}]}