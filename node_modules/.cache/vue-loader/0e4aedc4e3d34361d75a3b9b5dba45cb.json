{"remainingRequest":"/Users/const/Documents/Vue/tet/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/const/Documents/Vue/tet/src/components/Online.vue?vue&type=style&index=0&id=57d009fa&scoped=true&lang=less&","dependencies":[{"path":"/Users/const/Documents/Vue/tet/src/components/Online.vue","mtime":1557140735268},{"path":"/Users/const/Documents/Vue/tet/node_modules/css-loader/index.js","mtime":1552975947402},{"path":"/Users/const/Documents/Vue/tet/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1552975955943},{"path":"/Users/const/Documents/Vue/tet/node_modules/postcss-loader/src/index.js","mtime":1552975953218},{"path":"/Users/const/Documents/Vue/tet/node_modules/less-loader/dist/cjs.js","mtime":1552975951040},{"path":"/Users/const/Documents/Vue/tet/node_modules/cache-loader/dist/cjs.js","mtime":1552975946601},{"path":"/Users/const/Documents/Vue/tet/node_modules/vue-loader/lib/index.js","mtime":1552975955943}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.online {\n    height: 100vh;\n}\n.lineTitle {\n  padding: 12px 22px;\n  font-size: 16px;\n  color: #4d4d4d;\n}\n.content {\n    width: 100%;\n    height: 82vh;\n}\n.menu {\n    width: 100%;\n    height: 82vh;\n    color: #fff;\n}\n.swiper-container {\n    width: 100%;\n    height: 100%;\n}\n.menu i {\n    font-size: 36px;\n    color: #babcc2;\n}\n.swiper-slide {\n    // text-align: center;\n    // font-size: 18px;\n    // background: #fff;\n\n    // /* Center slide text vertically */\n    // display: -webkit-box;\n    // display: -ms-flexbox;\n    // display: -webkit-flex;\n    // display: flex;\n    // flex-direction: column;\n    // -webkit-box-pack: center;\n    // -ms-flex-pack: center;\n    // -webkit-justify-content: center;\n    // justify-content: center;\n    // -webkit-box-align: center;\n    // -ms-flex-align: center;\n    // -webkit-align-items: flex-start;\n    // align-items: flex-start;\n}\n.onLinePage {\n    margin: 26px 12px 0 0;\n    text-align: right;\n}\n.lineItem {\n  margin: 0 auto;\n  width: 94%;\n}\n.line-form {\n  padding: 22px;\n}\n.line-submit {\n  margin: 44px 0 0 0;\n}\n",{"version":3,"sources":["Online.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Online.vue","sourceRoot":"src/components","sourcesContent":["<template v-if=\"complete\">\n    <div class=\"online\">\n        <div class=\"swiper-container\">\n            <div class=\"swiper-wrapper\">\n                <div class=\"swiper-slide content\">\n                  <div class=\"lineTitle\">当前站点:【 aaa.com 】dev</div>\n                    <div class=\"line-form\">\n                      <el-form>\n                        <el-row :gutter=\"20\">\n                          <el-col :span=\"6\">\n                            <el-form-item label=\"项目选择: \" prop=\"site\">\n                              <el-select v-model=\"site\" @change=\"onSelect()\" size=\"medium\">\n                                <el-option\n                                    v-for=\"item in siteData\"\n                                    :key=\"item.value\"\n                                    :label=\"item.label\"\n                                    :value=\"item.value\">\n                                    <span style=\"float: left\">{{ item.label }}</span>\n                                    <span style=\"float: right; color: #8492a6; font-size: 14px\">{{ item.status ? '已完成配置('+ item.type +')' : '未配置' }}</span>\n                                </el-option>\n                              </el-select>\n                            </el-form-item>\n                          </el-col>\n                          <el-col :span=\"6\">\n                            <el-form-item label=\"默认分支: \" prop=\"branch\">\n                                <el-select v-model=\"branch\" size=\"medium\">\n                                    <el-option\n                                        v-for=\"item in branchData\"\n                                        :key=\"item.value\"\n                                        :label=\"item.label\"\n                                        :value=\"item.value\">\n                                    </el-option>\n                                </el-select>\n                            </el-form-item>\n                          </el-col>\n                          <el-col :span=\"6\">\n                            <el-form-item label=\"版本选择: \" prop=\"version\">\n                                <el-select v-model=\"version\" size=\"medium\">\n                                    <el-option\n                                        v-for=\"item in versionData\"\n                                        :key=\"item.value\" \n                                        :label=\"item.label\"\n                                        :value=\"item.value\">\n                                        <span style=\"float: left\">{{ item.label }}</span>\n                                        <span style=\"float: right; color: #8492a6; font-size: 14px\">{{ item.author }}</span>\n                                    </el-option>\n                                </el-select>\n                            </el-form-item>\n                          </el-col>\n                          <el-col :span=\"6\">\n                            <el-col :span=\"6\">\n                              <div class=\"line-submit\">\n                                <el-button type=\"primary\" size=\"mini\" @click=\"onRelease()\">release</el-button>\n                              </div>\n                            </el-col>\n                          </el-col>\n                        </el-row>\n                      </el-form>\n                    </div>\n                    <div>\n                      <Terminal/>\n                    </div>\n                </div>\n                <div class=\"swiper-slide menu\">\n                  <el-divider><i class=\"el-icon-arrow-up\"></i></el-divider>\n                    <div class=\"lineItem\">\n                      <template>\n                        <el-table\n                          :data=\"listData\"\n                          stripe\n                          style=\"width: 100%\">\n                          <el-table-column\n                            prop=\"time\"\n                            label=\"日期\"\n                            width=\"180\">\n                          </el-table-column>\n                          <el-table-column\n                            prop=\"developer\"\n                            label=\"开发者\"\n                            width=\"180\">\n                          </el-table-column>\n                          <el-table-column\n                            prop=\"mark\"\n                            label=\"备注\">\n                          </el-table-column>\n                          <el-table-column\n                            prop=\"version\"\n                            label=\"版本号\">\n                          </el-table-column>\n                          <el-table-column label=\"操作\">\n                            <template slot-scope=\"scope\">\n                                <el-button\n                                size=\"mini\"\n                                type=\"danger\"\n                                @click=\"onRollBack(scope.$index, scope.row)\">rollback</el-button>\n                            </template>\n                          </el-table-column>\n                        </el-table>\n                      </template>\n                      <template v-if=\"total > 1\">\n                          <div class=\"onLinePage\">\n                              <el-pagination\n                              background\n                              layout=\"prev, pager, next\"\n                              :total=\"total * 10\"\n                              :pager-count=\"5\"\n                              @current-change=\"onRender\">\n                              </el-pagination>\n                          </div>\n                      </template>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script lang=\"ts\">\nimport axios from 'axios';\nimport Qs from 'qs';\nimport {onTips} from '@/assets/js/common.js';\nimport Swiper from 'swiper';\nimport 'swiper/dist/css/swiper.min.css';\nimport Terminal from '@/components/Terminal.vue'\nexport default {\n    name: 'Online',\n    data() {\n      return {\n        complete: false,\n        total: Number,\n        listData: [],\n        site: '',\n        siteData: [],\n        branch: '',\n        branchData: [\n          { value: 1, label: 'aa' },\n        ],\n        version: 0,\n        versionData: []\n      }\n    },\n    components: {\n      Terminal\n    },\n    created() {\n      let that = this;\n      that.onInstance();\n      that.onRender(1);\n      \n    },\n    mounted() {\n      let that = this;\n      var mySwiper = new Swiper('.swiper-container', {\n          direction : 'vertical',\n          slidesPerView: 'auto',\n          initialSlide: 0,\n          resistanceRatio: 0,\n          slideToClickedSlide: true\n      });\n    },\n    methods: {\n      onRender: function(page) {\n        let that = this;\n        let data = {\n          'page': page\n        }\n        axios.post('/api/render', Qs.stringify(data), {})\n        .then(function(res) {\n          console.log(res);\n          if (res.data.status) {\n            that.listData = res.data.data.list;\n            that.total = res.data.data.page;\n          } else {\n            onTips(that, 'error', res.data.info);\n          }\n          that.complete = true;\n        })\n        .catch(function(err) {\n          onTips(that, 'error', '网络错误～');\n        })\n      },\n      onInstance: function() {\n        let that = this;\n        axios.post('/api/instance', {}, {})\n        .then(function(res) {\n          if (res.data.status) {\n            let resData = res.data.data.site;\n            let verData = res.data.data.version;\n            let braData = res.data.data.branch;\n\n            let site = '';\n            let siteData = [];\n            for (let i=0; i<resData.length; i++) {\n              if (resData[i].active) {\n                site = resData[i].id;\n              }\n              let data = {value: resData[i].id, label: resData[i].domain, status: resData[i].status, type: resData[i].type == 2 ? 'svn' : 'git'};\n              siteData.unshift(data);\n            }\n            that.siteData = siteData;\n            that.site = site;\n\n            // let version = '';\n            let versionData = [];\n\n            for (let i=0; i<verData.length; i++) {\n              let data = {value: i, author: verData[i].author, label: verData[i].version}\n              versionData.push(data) \n            }\n            that.versionData = versionData;\n\n            // let branch = '';\n            let branchData = [];\n\n            for (let i=0; i<braData.length; i++) {\n              let data = {value: i, label: braData[i]}\n              branchData.push(data)\n            }\n            that.branchData = branchData;\n            that.branch = res.data.data.init;\n\n          } else {\n            onTips(that, 'error', res.data.info);\n          }\n        })\n        .catch(function(err) {\n          onTips(that, 'error', '网络错误～');\n        })\n      },\n      onRelease: function() {\n        let that = this;\n        axios.post('/api/submit', {}, {})\n        .then(function(res) {\n          if (res.data.status) {\n            console.log('success')\n          } else {\n            onTips(that, 'error', res.data.info);\n          }\n        })\n        .catch(function(err) {\n          onTips(that, 'error', '网络错误～');\n        })\n      },\n      onRollBack: function(index, row) {\n        console.log(index, row);\n        let that = this;\n        axios.post('/api/rollback', {}, {})\n        .then(function(res) {\n          console.log(res, 'rollback')\n          if (res.data.status) {\n            console.log('aaa')\n          } else {\n            onTips(that, 'error', res.data.info);\n          }\n        })\n        .catch(function(err) {\n          onTips(that, 'error', '网络错误～');\n        })\n      },\n      onSelect: function() {\n        console.log(this.site);\n      }\n    }\n}\n</script>\n\n<style scoped lang=\"less\">\n.online {\n    height: 100vh;\n}\n.lineTitle {\n  padding: 12px 22px;\n  font-size: 16px;\n  color: #4d4d4d;\n}\n.content {\n    width: 100%;\n    height: 82vh;\n}\n.menu {\n    width: 100%;\n    height: 82vh;\n    color: #fff;\n}\n.swiper-container {\n    width: 100%;\n    height: 100%;\n}\n.menu i {\n    font-size: 36px;\n    color: #babcc2;\n}\n.swiper-slide {\n    // text-align: center;\n    // font-size: 18px;\n    // background: #fff;\n\n    // /* Center slide text vertically */\n    // display: -webkit-box;\n    // display: -ms-flexbox;\n    // display: -webkit-flex;\n    // display: flex;\n    // flex-direction: column;\n    // -webkit-box-pack: center;\n    // -ms-flex-pack: center;\n    // -webkit-justify-content: center;\n    // justify-content: center;\n    // -webkit-box-align: center;\n    // -ms-flex-align: center;\n    // -webkit-align-items: flex-start;\n    // align-items: flex-start;\n}\n.onLinePage {\n    margin: 26px 12px 0 0;\n    text-align: right;\n}\n.lineItem {\n  margin: 0 auto;\n  width: 94%;\n}\n.line-form {\n  padding: 22px;\n}\n.line-submit {\n  margin: 44px 0 0 0;\n}\n</style>"]}]}